{"ast":null,"code":"import { Subject, takeUntil } from 'rxjs';\nimport * as helper from '../../core/helpers/index';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/core\";\nimport * as i2 from \"ngx-toastr\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"src/app/core/services/file.storage.service\";\nimport * as i5 from \"src/app/shared/loading\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"@angular/material/input\";\nimport * as i8 from \"@angular/material/form-field\";\nexport class ProfileComponent {\n  constructor(jwtService, userService, toastr, router, storageService, loadingService) {\n    this.jwtService = jwtService;\n    this.userService = userService;\n    this.toastr = toastr;\n    this.router = router;\n    this.storageService = storageService;\n    this.loadingService = loadingService;\n    this.destroy$ = new Subject();\n    this.user = {};\n    this.userToUpdate = {};\n    this.user = JSON.parse(this.jwtService.getUserInfo());\n    this.userToUpdate = {\n      id: this.user?.userInfo?._id,\n      nombres: this.user?.userInfo?.nombres,\n      apellidos: this.user?.userInfo?.apellidos,\n      email: this.user?.userInfo?.email,\n      telefono: this.user?.userInfo?.telefono,\n      currentPassword: '',\n      newPassword: '',\n      confirmPassword: ''\n    };\n  }\n  ngOnInit() {\n    this.loadingService.setLoading(true);\n    this.storageService.downloadProfileImg(this.user.userInfo.fotoPerfil).pipe(takeUntil(this.destroy$)).subscribe({\n      next: response => {\n        const blobData = new Blob([response], {\n          type: 'image/jpeg'\n        });\n        const reader = new FileReader();\n        reader.readAsDataURL(blobData);\n        reader.onloadend = () => {\n          const base64data = reader.result;\n          this.user.userInfo.fotoPerfil = base64data;\n          this.loadingService.setLoading(false);\n        };\n      },\n      error: error => {\n        this.toastr.error('No se pudo cargar la foto de perfil', 'Error');\n        this.loadingService.setLoading(false);\n      }\n    });\n  }\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n  onUpdateProfile(event) {\n    event.preventDefault();\n    this.loadingService.setLoading(true);\n    const request = this.userToUpdate;\n    debugger;\n    this.userService.update(request).pipe(takeUntil(this.destroy$)).subscribe({\n      next: response => {\n        debugger;\n        this.toastr.success(response.message, 'Success');\n        this.loadingService.setLoading(false);\n        if (!helper.isNullOrWhitespace(request.newPassword)) {\n          this.userService.purgeAuth();\n          this.router.navigateByUrl('/login');\n          return;\n        }\n        this.assignToUserUpdated(response);\n        this.userService.setAuth(this.user);\n      },\n      error: error => {\n        console.log(error);\n        this.toastr.error('', 'Error');\n        this.loadingService.setLoading(false);\n      }\n    });\n  }\n  assignToUserUpdated(userUpdated) {\n    this.user.userInfo.nombres = userUpdated.userInfo.nombres;\n    this.user.userInfo.apellidos = userUpdated.userInfo.apellidos;\n    this.user.userInfo.email = userUpdated.userInfo.email;\n    this.user.userInfo.telefono = userUpdated.userInfo.telefono;\n  }\n}\nProfileComponent.ɵfac = function ProfileComponent_Factory(t) {\n  return new (t || ProfileComponent)(i0.ɵɵdirectiveInject(i1.JwtService), i0.ɵɵdirectiveInject(i1.UserService), i0.ɵɵdirectiveInject(i2.ToastrService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.FileStorageServices), i0.ɵɵdirectiveInject(i5.LoadingService));\n};\nProfileComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ProfileComponent,\n  selectors: [[\"app-profile\"]],\n  decls: 88,\n  vars: 14,\n  consts: [[1, \"profile-container\"], [1, \"title\"], [1, \"content\"], [1, \"user-details\"], [1, \"back-image-container\"], [\"loading\", \"lazy\", \"src\", \"https://demos.creative-tim.com/paper-dashboard-angular/assets/img/damir-bosnjak.jpg\", \"alt\", \"back-image\", 1, \"back-image\"], [1, \"user-image-container\"], [\"loading\", \"lazy\", \"alt\", \"user-image\", 1, \"user-image\", 3, \"src\"], [1, \"user-info\"], [1, \"user-name\"], [1, \"user-email\"], [1, \"fa\", \"fa-envelope\", \"icon\"], [1, \"user-phone\"], [1, \"fa\", \"fa-phone\", \"icon\"], [1, \"role\"], [1, \"edit-profile\", \"overflow-auto\"], [1, \"title-form\"], [3, \"submit\"], [1, \"grid-container\"], [1, \"\"], [1, \"label-form\"], [1, \"full-width\"], [\"type\", \"text\", \"matInput\", \"\", \"placeholder\", \"nombres\", \"name\", \"nombres\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"matInput\", \"\", \"placeholder\", \"apellidos\", \"name\", \"apellidos\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"matInput\", \"\", \"placeholder\", \"email\", \"name\", \"email\", 3, \"ngModel\", \"disabled\", \"ngModelChange\"], [\"type\", \"text\", \"matInput\", \"\", \"placeholder\", \"telefono\", \"name\", \"telefono\", 3, \"ngModel\", \"ngModelChange\"], [1, \"Password\"], [1, \"mb-2\"], [\"type\", \"password\", \"matInput\", \"\", \"placeholder\", \"contrase\\u00F1a actual\", \"name\", \"currentPassword\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"password\", \"matInput\", \"\", \"placeholder\", \"contrase\\u00F1a nueva\", \"name\", \"newPassword\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"password\", \"matInput\", \"\", \"placeholder\", \"contrase\\u00F1a nueva\", \"name\", \"confirmPassword\", 3, \"ngModel\", \"ngModelChange\"], [1, \"btn-update\"]],\n  template: function ProfileComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"main\", 0)(1, \"h4\", 1);\n      i0.ɵɵtext(2, \"Perfil de Usuario\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(3, \"hr\");\n      i0.ɵɵelementStart(4, \"div\", 2)(5, \"section\", 3)(6, \"div\", 4);\n      i0.ɵɵelement(7, \"img\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"div\", 6);\n      i0.ɵɵelement(9, \"img\", 7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"div\", 8)(11, \"h4\", 9);\n      i0.ɵɵtext(12);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"p\", 10);\n      i0.ɵɵelement(14, \"i\", 11);\n      i0.ɵɵelementStart(15, \"span\");\n      i0.ɵɵtext(16);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(17, \"p\", 12);\n      i0.ɵɵelement(18, \"i\", 13);\n      i0.ɵɵelementStart(19, \"span\");\n      i0.ɵɵtext(20);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelement(21, \"hr\");\n      i0.ɵɵelementStart(22, \"div\", 14);\n      i0.ɵɵtext(23);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(24, \"aside\", 15)(25, \"h4\", 16);\n      i0.ɵɵtext(26, \"Editar Perfil\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(27, \"form\", 17);\n      i0.ɵɵlistener(\"submit\", function ProfileComponent_Template_form_submit_27_listener($event) {\n        return ctx.onUpdateProfile($event);\n      });\n      i0.ɵɵelementStart(28, \"section\", 18)(29, \"div\")(30, \"div\", 19)(31, \"h4\", 16);\n      i0.ɵɵtext(32, \"Informacion Personal\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(33, \"div\")(34, \"label\", 20);\n      i0.ɵɵtext(35, \"Nombres\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(36, \"mat-form-field\", 21)(37, \"mat-label\");\n      i0.ɵɵtext(38, \"Nombres\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(39, \"input\", 22);\n      i0.ɵɵlistener(\"ngModelChange\", function ProfileComponent_Template_input_ngModelChange_39_listener($event) {\n        return ctx.userToUpdate.nombres = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(40, \"div\")(41, \"label\", 20);\n      i0.ɵɵtext(42, \"Apellidos\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(43, \"mat-form-field\", 21)(44, \"mat-label\");\n      i0.ɵɵtext(45, \"Apellidos\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(46, \"input\", 23);\n      i0.ɵɵlistener(\"ngModelChange\", function ProfileComponent_Template_input_ngModelChange_46_listener($event) {\n        return ctx.userToUpdate.apellidos = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(47, \"div\")(48, \"label\", 20);\n      i0.ɵɵtext(49, \"Email\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(50, \"mat-form-field\", 21)(51, \"mat-label\");\n      i0.ɵɵtext(52, \"Email\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(53, \"input\", 24);\n      i0.ɵɵlistener(\"ngModelChange\", function ProfileComponent_Template_input_ngModelChange_53_listener($event) {\n        return ctx.userToUpdate.email = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(54, \"div\")(55, \"label\", 20);\n      i0.ɵɵtext(56, \"Telefono\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(57, \"mat-form-field\", 21)(58, \"mat-label\");\n      i0.ɵɵtext(59, \"Telefono\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(60, \"input\", 25);\n      i0.ɵɵlistener(\"ngModelChange\", function ProfileComponent_Template_input_ngModelChange_60_listener($event) {\n        return ctx.userToUpdate.telefono = $event;\n      });\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(61, \"div\", 26)(62, \"div\", 27)(63, \"h4\", 16);\n      i0.ɵɵtext(64, \"Cambiar Contrase\\u00F1a\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(65, \"div\")(66, \"label\", 20);\n      i0.ɵɵtext(67, \"Contrase\\u00F1a Actual\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(68, \"mat-form-field\", 21)(69, \"mat-label\");\n      i0.ɵɵtext(70, \"Contrase\\u00F1a Actual\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(71, \"input\", 28);\n      i0.ɵɵlistener(\"ngModelChange\", function ProfileComponent_Template_input_ngModelChange_71_listener($event) {\n        return ctx.userToUpdate.currentPassword = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(72, \"div\")(73, \"label\", 20);\n      i0.ɵɵtext(74, \"Contrase\\u00F1a Nueva\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(75, \"mat-form-field\", 21)(76, \"mat-label\");\n      i0.ɵɵtext(77, \"Contrase\\u00F1a Nueva\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(78, \"input\", 29);\n      i0.ɵɵlistener(\"ngModelChange\", function ProfileComponent_Template_input_ngModelChange_78_listener($event) {\n        return ctx.userToUpdate.newPassword = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(79, \"div\")(80, \"label\", 20);\n      i0.ɵɵtext(81, \"Confirmar Contrase\\u00F1a Nueva\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(82, \"mat-form-field\", 21)(83, \"mat-label\");\n      i0.ɵɵtext(84, \"Confirmar Contrase\\u00F1a Nueva\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(85, \"input\", 30);\n      i0.ɵɵlistener(\"ngModelChange\", function ProfileComponent_Template_input_ngModelChange_85_listener($event) {\n        return ctx.userToUpdate.confirmPassword = $event;\n      });\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(86, \"button\", 31);\n      i0.ɵɵtext(87, \"Actualizar Perfil\");\n      i0.ɵɵelementEnd()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"src\", ctx.user.userInfo.fotoPerfil, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate2(\"\", ctx.user.userInfo.nombres, \" \", ctx.user.userInfo.apellidos, \" \");\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate1(\" \", ctx.user.userInfo.email, \" \");\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate1(\" \", ctx.user.userInfo.telefono, \" \");\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate(ctx.user.userInfo.rol);\n      i0.ɵɵadvance(16);\n      i0.ɵɵproperty(\"ngModel\", ctx.userToUpdate.nombres);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngModel\", ctx.userToUpdate.apellidos);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngModel\", ctx.userToUpdate.email)(\"disabled\", true);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngModel\", ctx.userToUpdate.telefono);\n      i0.ɵɵadvance(11);\n      i0.ɵɵproperty(\"ngModel\", ctx.userToUpdate.currentPassword);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngModel\", ctx.userToUpdate.newPassword);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngModel\", ctx.userToUpdate.confirmPassword);\n    }\n  },\n  dependencies: [i6.ɵNgNoValidate, i6.DefaultValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.NgModel, i6.NgForm, i7.MatInput, i8.MatFormField, i8.MatLabel],\n  styles: [\"p[_ngcontent-%COMP%] {\\r\\n  font-size: 0.9rem;\\r\\n  font-weight: 500;\\r\\n  line-height: 1.2rem;\\r\\n  color: #9a9a9a;\\r\\n  margin-bottom: 0;\\r\\n}\\r\\n\\r\\n.profile-container[_ngcontent-%COMP%] {\\r\\n  width: min(95%, 120rem);\\r\\n}\\r\\n\\r\\n.content[_ngcontent-%COMP%] {\\r\\n  display: grid;\\r\\n  align-items: flex-start;\\r\\n  gap: 2rem;\\r\\n  grid-template-columns: 1.5fr 3.5fr;\\r\\n  margin: 0 2rem;\\r\\n}\\r\\n\\r\\n.title[_ngcontent-%COMP%] {\\r\\n  margin: 1.2rem 1rem;\\r\\n  font-size: 1.2rem;\\r\\n  font-weight: 500;\\r\\n  line-height: 1rem;\\r\\n  color: #9a9a9a;\\r\\n}\\r\\n\\r\\n.user-details[_ngcontent-%COMP%] {\\r\\n  height: auto;\\r\\n  width: 100%;\\r\\n  padding-bottom: 1rem;\\r\\n  border-radius: 0.5rem;\\r\\n  background-color: #fff;\\r\\n  box-shadow: 0 0.2rem 0.5rem rgba(0, 0, 0, 0.1);\\r\\n\\r\\n}\\r\\n\\r\\n.back-image-container[_ngcontent-%COMP%] {\\r\\n  width: 100%;\\r\\n  height: 7rem;\\r\\n  object-fit: cover;\\r\\n  border-radius: 0.5rem 0.5rem 0 0;\\r\\n}\\r\\n\\r\\n.back-image[_ngcontent-%COMP%] {\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  object-fit: cover;\\r\\n  border-radius: 0.5rem 0.5rem 0 0;\\r\\n}\\r\\n\\r\\n.user-image-container[_ngcontent-%COMP%]{\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  display: flex;\\r\\n  justify-content: center;\\r\\n  align-items: center;\\r\\n  overflow: hidden;\\r\\n  margin-top: -4rem;\\r\\n}\\r\\n\\r\\n.user-image[_ngcontent-%COMP%] {\\r\\n  width: 8rem;\\r\\n  height: 8rem;\\r\\n  object-fit: cover;\\r\\n  border: 1px solid #fff;\\r\\n  border-radius: 50%;\\r\\n}\\r\\n\\r\\n.user-info[_ngcontent-%COMP%] {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  justify-content: center;\\r\\n  align-items: center;\\r\\n  margin-top: 1.5rem;\\r\\n  gap: 1rem;\\r\\n}\\r\\n\\r\\n.user-name[_ngcontent-%COMP%] {\\r\\n  font-size: 1.2rem;\\r\\n  font-weight: 600;\\r\\n  line-height: 1.2rem;\\r\\n  text-transform: capitalize;\\r\\n  text-align: center;\\r\\n  letter-spacing: .1rem;\\r\\n  margin-bottom: 0;\\r\\n  color: #51cbce;\\r\\n}\\r\\n\\r\\n.icon[_ngcontent-%COMP%] {\\r\\n  font-size: 1.1rem;\\r\\n  color: #51cbce;\\r\\n  margin-right: .2rem;\\r\\n}\\r\\n\\r\\n.role[_ngcontent-%COMP%] {\\r\\n  display: grid;\\r\\n  place-content: center;\\r\\n  font-size: 1rem;\\r\\n  text-transform: uppercase;\\r\\n  font-weight: 500;\\r\\n  line-height: 1.2rem;\\r\\n  color: #9a9a9a;\\r\\n}\\r\\n\\r\\n.edit-profile[_ngcontent-%COMP%] {\\r\\n  background-color: #fff;\\r\\n  border-radius: .5rem;\\r\\n  height: auto;\\r\\n  width: 100%;\\r\\n  padding: 1rem;\\r\\n}\\r\\n\\r\\n.title-form[_ngcontent-%COMP%] {\\r\\n  margin-top: 1rem;\\r\\n  font-size: 1.2rem;\\r\\n  font-weight: 500;\\r\\n  line-height: 1rem;\\r\\n  color: #9a9a9a;\\r\\n}\\r\\n\\r\\n.name-container[_ngcontent-%COMP%] {\\r\\n  display: grid;\\r\\n  grid-template-columns: 1fr 1fr;\\r\\n  gap: 1rem;\\r\\n  width: 100%;\\r\\n}\\r\\n\\r\\n.full-width[_ngcontent-%COMP%] {\\r\\n  width: 100%;\\r\\n}\\r\\n\\r\\n.grid-container[_ngcontent-%COMP%] {\\r\\n  display: grid;\\r\\n  grid-template-columns: 1fr 1fr;\\r\\n  gap: 1rem;\\r\\n}\\r\\n\\r\\n.label-form[_ngcontent-%COMP%] {\\r\\n  font-size: .7rem;\\r\\n  font-weight: 500;\\r\\n  line-height: 1rem;\\r\\n  color: #9a9a9a;\\r\\n}\\r\\n\\r\\n.btn-update[_ngcontent-%COMP%] {\\r\\n  background-color: #51cbce;\\r\\n  color: #fff;\\r\\n  border-radius: .5rem;\\r\\n  font-size: 1rem;\\r\\n  font-weight: 500;\\r\\n  line-height: 1.2rem;\\r\\n  text-transform: uppercase;\\r\\n  padding: .5rem 1rem;\\r\\n  border: none;\\r\\n  cursor: pointer;\\r\\n  display: block;\\r\\n  width: 100%;\\r\\n  transition: all 200ms ease-in-out;\\r\\n}\\r\\n\\r\\n.btn-update[_ngcontent-%COMP%]:hover {\\r\\n  background-color: white;\\r\\n  color: #51cbce;\\r\\n  border: 2px solid #51cbce;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcGFnZXMvcHJvZmlsZS9wcm9maWxlLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxpQkFBaUI7RUFDakIsZ0JBQWdCO0VBQ2hCLG1CQUFtQjtFQUNuQixjQUFjO0VBQ2QsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsdUJBQXVCO0FBQ3pCOztBQUVBO0VBQ0UsYUFBYTtFQUNiLHVCQUF1QjtFQUN2QixTQUFTO0VBQ1Qsa0NBQWtDO0VBQ2xDLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxtQkFBbUI7RUFDbkIsaUJBQWlCO0VBQ2pCLGdCQUFnQjtFQUNoQixpQkFBaUI7RUFDakIsY0FBYztBQUNoQjs7QUFFQTtFQUNFLFlBQVk7RUFDWixXQUFXO0VBQ1gsb0JBQW9CO0VBQ3BCLHFCQUFxQjtFQUNyQixzQkFBc0I7RUFDdEIsOENBQThDOztBQUVoRDs7QUFFQTtFQUNFLFdBQVc7RUFDWCxZQUFZO0VBQ1osaUJBQWlCO0VBQ2pCLGdDQUFnQztBQUNsQzs7QUFFQTtFQUNFLFdBQVc7RUFDWCxZQUFZO0VBQ1osaUJBQWlCO0VBQ2pCLGdDQUFnQztBQUNsQzs7QUFFQTtFQUNFLFdBQVc7RUFDWCxZQUFZO0VBQ1osYUFBYTtFQUNiLHVCQUF1QjtFQUN2QixtQkFBbUI7RUFDbkIsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxZQUFZO0VBQ1osaUJBQWlCO0VBQ2pCLHNCQUFzQjtFQUN0QixrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSxhQUFhO0VBQ2Isc0JBQXNCO0VBQ3RCLHVCQUF1QjtFQUN2QixtQkFBbUI7RUFDbkIsa0JBQWtCO0VBQ2xCLFNBQVM7QUFDWDs7QUFFQTtFQUNFLGlCQUFpQjtFQUNqQixnQkFBZ0I7RUFDaEIsbUJBQW1CO0VBQ25CLDBCQUEwQjtFQUMxQixrQkFBa0I7RUFDbEIscUJBQXFCO0VBQ3JCLGdCQUFnQjtFQUNoQixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsaUJBQWlCO0VBQ2pCLGNBQWM7RUFDZCxtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxhQUFhO0VBQ2IscUJBQXFCO0VBQ3JCLGVBQWU7RUFDZix5QkFBeUI7RUFDekIsZ0JBQWdCO0VBQ2hCLG1CQUFtQjtFQUNuQixjQUFjO0FBQ2hCOztBQUVBO0VBQ0Usc0JBQXNCO0VBQ3RCLG9CQUFvQjtFQUNwQixZQUFZO0VBQ1osV0FBVztFQUNYLGFBQWE7QUFDZjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixpQkFBaUI7RUFDakIsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtFQUNqQixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsYUFBYTtFQUNiLDhCQUE4QjtFQUM5QixTQUFTO0VBQ1QsV0FBVztBQUNiOztBQUVBO0VBQ0UsV0FBVztBQUNiOztBQUVBO0VBQ0UsYUFBYTtFQUNiLDhCQUE4QjtFQUM5QixTQUFTO0FBQ1g7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtFQUNqQixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UseUJBQXlCO0VBQ3pCLFdBQVc7RUFDWCxvQkFBb0I7RUFDcEIsZUFBZTtFQUNmLGdCQUFnQjtFQUNoQixtQkFBbUI7RUFDbkIseUJBQXlCO0VBQ3pCLG1CQUFtQjtFQUNuQixZQUFZO0VBQ1osZUFBZTtFQUNmLGNBQWM7RUFDZCxXQUFXO0VBQ1gsaUNBQWlDO0FBQ25DOztBQUVBO0VBQ0UsdUJBQXVCO0VBQ3ZCLGNBQWM7RUFDZCx5QkFBeUI7QUFDM0IiLCJzb3VyY2VzQ29udGVudCI6WyJwIHtcclxuICBmb250LXNpemU6IDAuOXJlbTtcclxuICBmb250LXdlaWdodDogNTAwO1xyXG4gIGxpbmUtaGVpZ2h0OiAxLjJyZW07XHJcbiAgY29sb3I6ICM5YTlhOWE7XHJcbiAgbWFyZ2luLWJvdHRvbTogMDtcclxufVxyXG5cclxuLnByb2ZpbGUtY29udGFpbmVyIHtcclxuICB3aWR0aDogbWluKDk1JSwgMTIwcmVtKTtcclxufVxyXG5cclxuLmNvbnRlbnQge1xyXG4gIGRpc3BsYXk6IGdyaWQ7XHJcbiAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XHJcbiAgZ2FwOiAycmVtO1xyXG4gIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMS41ZnIgMy41ZnI7XHJcbiAgbWFyZ2luOiAwIDJyZW07XHJcbn1cclxuXHJcbi50aXRsZSB7XHJcbiAgbWFyZ2luOiAxLjJyZW0gMXJlbTtcclxuICBmb250LXNpemU6IDEuMnJlbTtcclxuICBmb250LXdlaWdodDogNTAwO1xyXG4gIGxpbmUtaGVpZ2h0OiAxcmVtO1xyXG4gIGNvbG9yOiAjOWE5YTlhO1xyXG59XHJcblxyXG4udXNlci1kZXRhaWxzIHtcclxuICBoZWlnaHQ6IGF1dG87XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgcGFkZGluZy1ib3R0b206IDFyZW07XHJcbiAgYm9yZGVyLXJhZGl1czogMC41cmVtO1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICNmZmY7XHJcbiAgYm94LXNoYWRvdzogMCAwLjJyZW0gMC41cmVtIHJnYmEoMCwgMCwgMCwgMC4xKTtcclxuXHJcbn1cclxuXHJcbi5iYWNrLWltYWdlLWNvbnRhaW5lciB7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgaGVpZ2h0OiA3cmVtO1xyXG4gIG9iamVjdC1maXQ6IGNvdmVyO1xyXG4gIGJvcmRlci1yYWRpdXM6IDAuNXJlbSAwLjVyZW0gMCAwO1xyXG59XHJcblxyXG4uYmFjay1pbWFnZSB7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgaGVpZ2h0OiAxMDAlO1xyXG4gIG9iamVjdC1maXQ6IGNvdmVyO1xyXG4gIGJvcmRlci1yYWRpdXM6IDAuNXJlbSAwLjVyZW0gMCAwO1xyXG59XHJcblxyXG4udXNlci1pbWFnZS1jb250YWluZXJ7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgaGVpZ2h0OiAxMDAlO1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gIG1hcmdpbi10b3A6IC00cmVtO1xyXG59XHJcblxyXG4udXNlci1pbWFnZSB7XHJcbiAgd2lkdGg6IDhyZW07XHJcbiAgaGVpZ2h0OiA4cmVtO1xyXG4gIG9iamVjdC1maXQ6IGNvdmVyO1xyXG4gIGJvcmRlcjogMXB4IHNvbGlkICNmZmY7XHJcbiAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG59XHJcblxyXG4udXNlci1pbmZvIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBtYXJnaW4tdG9wOiAxLjVyZW07XHJcbiAgZ2FwOiAxcmVtO1xyXG59XHJcblxyXG4udXNlci1uYW1lIHtcclxuICBmb250LXNpemU6IDEuMnJlbTtcclxuICBmb250LXdlaWdodDogNjAwO1xyXG4gIGxpbmUtaGVpZ2h0OiAxLjJyZW07XHJcbiAgdGV4dC10cmFuc2Zvcm06IGNhcGl0YWxpemU7XHJcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gIGxldHRlci1zcGFjaW5nOiAuMXJlbTtcclxuICBtYXJnaW4tYm90dG9tOiAwO1xyXG4gIGNvbG9yOiAjNTFjYmNlO1xyXG59XHJcblxyXG4uaWNvbiB7XHJcbiAgZm9udC1zaXplOiAxLjFyZW07XHJcbiAgY29sb3I6ICM1MWNiY2U7XHJcbiAgbWFyZ2luLXJpZ2h0OiAuMnJlbTtcclxufVxyXG5cclxuLnJvbGUge1xyXG4gIGRpc3BsYXk6IGdyaWQ7XHJcbiAgcGxhY2UtY29udGVudDogY2VudGVyO1xyXG4gIGZvbnQtc2l6ZTogMXJlbTtcclxuICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xyXG4gIGZvbnQtd2VpZ2h0OiA1MDA7XHJcbiAgbGluZS1oZWlnaHQ6IDEuMnJlbTtcclxuICBjb2xvcjogIzlhOWE5YTtcclxufVxyXG5cclxuLmVkaXQtcHJvZmlsZSB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcclxuICBib3JkZXItcmFkaXVzOiAuNXJlbTtcclxuICBoZWlnaHQ6IGF1dG87XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgcGFkZGluZzogMXJlbTtcclxufVxyXG5cclxuLnRpdGxlLWZvcm0ge1xyXG4gIG1hcmdpbi10b3A6IDFyZW07XHJcbiAgZm9udC1zaXplOiAxLjJyZW07XHJcbiAgZm9udC13ZWlnaHQ6IDUwMDtcclxuICBsaW5lLWhlaWdodDogMXJlbTtcclxuICBjb2xvcjogIzlhOWE5YTtcclxufVxyXG5cclxuLm5hbWUtY29udGFpbmVyIHtcclxuICBkaXNwbGF5OiBncmlkO1xyXG4gIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDFmcjtcclxuICBnYXA6IDFyZW07XHJcbiAgd2lkdGg6IDEwMCU7XHJcbn1cclxuXHJcbi5mdWxsLXdpZHRoIHtcclxuICB3aWR0aDogMTAwJTtcclxufVxyXG5cclxuLmdyaWQtY29udGFpbmVyIHtcclxuICBkaXNwbGF5OiBncmlkO1xyXG4gIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDFmcjtcclxuICBnYXA6IDFyZW07XHJcbn1cclxuXHJcbi5sYWJlbC1mb3JtIHtcclxuICBmb250LXNpemU6IC43cmVtO1xyXG4gIGZvbnQtd2VpZ2h0OiA1MDA7XHJcbiAgbGluZS1oZWlnaHQ6IDFyZW07XHJcbiAgY29sb3I6ICM5YTlhOWE7XHJcbn1cclxuXHJcbi5idG4tdXBkYXRlIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjNTFjYmNlO1xyXG4gIGNvbG9yOiAjZmZmO1xyXG4gIGJvcmRlci1yYWRpdXM6IC41cmVtO1xyXG4gIGZvbnQtc2l6ZTogMXJlbTtcclxuICBmb250LXdlaWdodDogNTAwO1xyXG4gIGxpbmUtaGVpZ2h0OiAxLjJyZW07XHJcbiAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcclxuICBwYWRkaW5nOiAuNXJlbSAxcmVtO1xyXG4gIGJvcmRlcjogbm9uZTtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgZGlzcGxheTogYmxvY2s7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgdHJhbnNpdGlvbjogYWxsIDIwMG1zIGVhc2UtaW4tb3V0O1xyXG59XHJcblxyXG4uYnRuLXVwZGF0ZTpob3ZlciB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XHJcbiAgY29sb3I6ICM1MWNiY2U7XHJcbiAgYm9yZGVyOiAycHggc29saWQgIzUxY2JjZTtcclxufVxyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["Subject","takeUntil","helper","ProfileComponent","constructor","jwtService","userService","toastr","router","storageService","loadingService","user","JSON","parse","getUserInfo","userToUpdate","id","userInfo","_id","nombres","apellidos","email","telefono","currentPassword","newPassword","confirmPassword","ngOnInit","setLoading","downloadProfileImg","fotoPerfil","pipe","destroy$","subscribe","next","response","blobData","Blob","type","reader","FileReader","readAsDataURL","onloadend","base64data","result","error","ngOnDestroy","complete","onUpdateProfile","event","preventDefault","request","update","success","message","isNullOrWhitespace","purgeAuth","navigateByUrl","assignToUserUpdated","setAuth","console","log","userUpdated","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["C:\\Users\\nayeli\\OneDrive\\Escritorio\\service-desk\\frontend\\src\\app\\pages\\profile\\profile.component.ts","C:\\Users\\nayeli\\OneDrive\\Escritorio\\service-desk\\frontend\\src\\app\\pages\\profile\\profile.component.html"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { Subject, takeUntil } from 'rxjs'\r\nimport { JwtService, UserService } from 'src/app/core';\r\nimport { UpdateUserRequest, UserResponse } from 'src/app/core/interfaces/user.interface';\r\nimport { FileStorageServices } from 'src/app/core/services/file.storage.service';\r\nimport { LoadingService } from 'src/app/shared/loading';\r\nimport * as helper from '../../core/helpers/index';\r\n\r\n@Component({\r\n  selector: 'app-profile',\r\n  templateUrl: './profile.component.html',\r\n  styleUrls: ['./profile.component.css'],\r\n})\r\nexport class ProfileComponent {\r\n  private destroy$: Subject<void> = new Subject<void>();\r\n  user: UserResponse = {} as UserResponse;\r\n  userToUpdate: UpdateUserRequest = {} as UpdateUserRequest;\r\n  constructor(\r\n    private jwtService: JwtService,\r\n    private userService: UserService,\r\n    private toastr: ToastrService,\r\n    private router: Router,\r\n    private storageService: FileStorageServices,\r\n    private loadingService: LoadingService,\r\n  ) {\r\n    this.user = JSON.parse(this.jwtService.getUserInfo());\r\n\r\n    this.userToUpdate = {\r\n      id: this.user?.userInfo?._id,\r\n      nombres: this.user?.userInfo?.nombres,\r\n      apellidos: this.user?.userInfo?.apellidos,\r\n      email: this.user?.userInfo?.email,\r\n      telefono: this.user?.userInfo?.telefono,\r\n      currentPassword: '',\r\n      newPassword: '',\r\n      confirmPassword: '',\r\n    };\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.loadingService.setLoading(true);\r\n    this.storageService.downloadProfileImg(this.user.userInfo.fotoPerfil)\r\n      .pipe(takeUntil(this.destroy$))\r\n      .subscribe({\r\n        next: (response) => {\r\n          const blobData: Blob = new Blob([response], { type: 'image/jpeg' });\r\n          const reader = new FileReader();\r\n          reader.readAsDataURL(blobData);\r\n          reader.onloadend = () => {\r\n            const base64data = reader.result;\r\n            this.user.userInfo.fotoPerfil = base64data as string;\r\n            this.loadingService.setLoading(false);\r\n          }\r\n        },\r\n        error: (error) => {\r\n          this.toastr.error('No se pudo cargar la foto de perfil', 'Error');\r\n          this.loadingService.setLoading(false);\r\n        },\r\n      });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.destroy$.next();\r\n    this.destroy$.complete(); \r\n  }\r\n\r\n  onUpdateProfile(event: any) {\r\n    event.preventDefault();\r\n    this.loadingService.setLoading(true);\r\n    const request: UpdateUserRequest = this.userToUpdate;\r\n    debugger;\r\n    this.userService\r\n      .update(request)\r\n      .pipe(takeUntil(this.destroy$))\r\n      .subscribe({\r\n        next: (response) => {debugger;\r\n          this.toastr.success(response.message, 'Success');\r\n          this.loadingService.setLoading(false);\r\n          if(!helper.isNullOrWhitespace(request.newPassword)){\r\n            this.userService.purgeAuth();\r\n            this.router.navigateByUrl('/login');\r\n            return;\r\n          }\r\n          this.assignToUserUpdated(response);\r\n          this.userService.setAuth(this.user);\r\n        },\r\n        error: (error) => {\r\n          console.log(error);\r\n          this.toastr.error('', 'Error');\r\n          this.loadingService.setLoading(false);\r\n        },\r\n      });\r\n  }\r\n\r\n  assignToUserUpdated(userUpdated: UserResponse){\r\n    this.user.userInfo.nombres = userUpdated.userInfo.nombres;\r\n    this.user.userInfo.apellidos = userUpdated.userInfo.apellidos;\r\n    this.user.userInfo.email = userUpdated.userInfo.email;\r\n    this.user.userInfo.telefono = userUpdated.userInfo.telefono;\r\n  }\r\n}\r\n","<main class=\"profile-container\">\r\n  <h4 class=\"title\">Perfil de Usuario</h4>\r\n  <hr>\r\n  <div class=\"content\">\r\n    <section class=\"user-details\">\r\n      <div class=\"back-image-container\">\r\n        <img loading=\"lazy\" src=\"https://demos.creative-tim.com/paper-dashboard-angular/assets/img/damir-bosnjak.jpg\" alt=\"back-image\" class=\"back-image\" />\r\n      </div>\r\n      <div class=\"user-image-container\">\r\n        <img loading=\"lazy\" [src]=\"user.userInfo.fotoPerfil\" class=\"user-image\" alt=\"user-image\">\r\n      </div>\r\n      <div class=\"user-info\">\r\n        <h4 class=\"user-name\">{{user.userInfo.nombres}} {{user.userInfo.apellidos}} </h4>\r\n        <p class=\"user-email\">\r\n          <i class=\"fa fa-envelope icon\" ></i>\r\n          <span>\r\n            {{user.userInfo.email}}\r\n          </span>\r\n        </p>\r\n        <p class=\"user-phone\">\r\n          <i class=\"fa fa-phone icon\"></i>\r\n          <span>\r\n            {{user.userInfo.telefono}}\r\n          </span>\r\n        </p>\r\n      </div>\r\n      <hr>\r\n      <div class=\"role\">{{user.userInfo.rol}}</div>\r\n    </section>\r\n  \r\n    <aside class=\"edit-profile overflow-auto\">\r\n      <h4 class=\"title-form\">Editar Perfil</h4>\r\n      <form (submit)=\"onUpdateProfile($event)\">\r\n        <section class=\"grid-container\">\r\n          <div>\r\n            <div class=\"\" ><h4 class=\"title-form\">Informacion Personal</h4></div>\r\n            <div>\r\n              <label class=\"label-form\">Nombres</label>\r\n              <mat-form-field class=\"full-width\">\r\n                <mat-label>Nombres</mat-label>\r\n                <input type=\"text\" matInput placeholder=\"nombres\" [(ngModel)]=\"userToUpdate.nombres\" name=\"nombres\" >\r\n              </mat-form-field>\r\n            </div>\r\n            <div>\r\n              <label class=\"label-form\">Apellidos</label>\r\n              <mat-form-field class=\"full-width\">\r\n                <mat-label>Apellidos</mat-label>\r\n                <input type=\"text\" matInput placeholder=\"apellidos\" [(ngModel)]=\"userToUpdate.apellidos\" name=\"apellidos\" >\r\n              </mat-form-field>\r\n            </div>\r\n            <div>\r\n              <label class=\"label-form\">Email</label>\r\n              <mat-form-field class=\"full-width\">\r\n                <mat-label>Email</mat-label>\r\n                <input type=\"text\" matInput placeholder=\"email\" [(ngModel)]=\"userToUpdate.email\" name=\"email\" [disabled]=\"true\">\r\n              </mat-form-field>\r\n            </div>\r\n            <div>\r\n              <label class=\"label-form\">Telefono</label>\r\n              <mat-form-field class=\"full-width\">\r\n                <mat-label>Telefono</mat-label>\r\n                <input type=\"text\" matInput placeholder=\"telefono\" [(ngModel)]=\"userToUpdate.telefono\" name=\"telefono\" >\r\n              </mat-form-field>\r\n            </div>\r\n          </div>\r\n          <div class=\"Password\">\r\n            <div class=\"mb-2\" ><h4 class=\"title-form\">Cambiar Contraseña</h4></div>\r\n            <div>\r\n              <label class=\"label-form\">Contraseña Actual</label>\r\n              <mat-form-field class=\"full-width\">\r\n                <mat-label>Contraseña Actual</mat-label>\r\n                <input type=\"password\" matInput placeholder=\"contraseña actual\" [(ngModel)]=\"userToUpdate.currentPassword\" name=\"currentPassword\" >\r\n              </mat-form-field>\r\n            </div>\r\n            <div>\r\n              <label class=\"label-form\">Contraseña Nueva</label>\r\n              <mat-form-field class=\"full-width\">\r\n                <mat-label>Contraseña Nueva</mat-label>\r\n                <input type=\"password\" matInput placeholder=\"contraseña nueva\" [(ngModel)]=\"userToUpdate.newPassword\" name=\"newPassword\" >\r\n              </mat-form-field>\r\n            </div>\r\n            <div>\r\n              <label class=\"label-form\">Confirmar Contraseña Nueva</label>\r\n              <mat-form-field class=\"full-width\">\r\n                <mat-label>Confirmar Contraseña Nueva</mat-label>\r\n                <input type=\"password\" matInput placeholder=\"contraseña nueva\" [(ngModel)]=\"userToUpdate.confirmPassword\" name=\"confirmPassword\" >\r\n              </mat-form-field>\r\n            </div>\r\n          </div>\r\n        </section>\r\n        <button class=\"btn-update\">Actualizar Perfil</button>\r\n      </form>\r\n    </aside>\r\n  </div>\r\n</main>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}