{"ast":null,"code":"import { FormControl, FormGroup } from '@angular/forms';\nimport { status } from '../estados/constant';\nimport { forkJoin } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/core\";\nimport * as i2 from \"ngx-toastr\";\nimport * as i3 from \"src/app/core/services/status.service\";\nimport * as i4 from \"src/app/core/services/priority.service\";\nimport * as i5 from \"src/app/core/services/categories.service\";\nimport * as i6 from \"src/app/core/services/flujo.service\";\nimport * as i7 from \"@angular/router\";\nimport * as i8 from \"src/app/shared/loading\";\nimport * as i9 from \"@angular/common\";\nimport * as i10 from \"@angular/forms\";\nfunction CreateTicketsComponent_option_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 23)(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const priority_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", priority_r3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", priority_r3, \" \");\n  }\n}\nfunction CreateTicketsComponent_option_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 23)(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const category_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", category_r4);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", category_r4, \" \");\n  }\n}\nfunction CreateTicketsComponent_option_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 23)(1, \"p\", 24);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const flujo_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", flujo_r5);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", flujo_r5, \" \");\n  }\n}\nexport class CreateTicketsComponent {\n  constructor(ticketService, toastr, statusService, priorityService, categoryService, flujoService, router, loadingService) {\n    this.ticketService = ticketService;\n    this.toastr = toastr;\n    this.statusService = statusService;\n    this.priorityService = priorityService;\n    this.categoryService = categoryService;\n    this.flujoService = flujoService;\n    this.router = router;\n    this.loadingService = loadingService;\n    this.destroy$ = [];\n    this.categories = [];\n    this.categoryKeys = [];\n    this.ticketResponse = {};\n    this.status = [];\n    this.priorities = [];\n    this.priorityKeys = [];\n    this.flujos = [];\n    this.flujoKeys = [];\n    this.ticketForm = new FormGroup({\n      prioritiesSelect: new FormControl(this.priorities),\n      categoriesSelect: new FormControl(this.categories),\n      flujosSelect: new FormControl(this.flujos),\n      asunto: new FormControl(''),\n      contenido: new FormControl('')\n    });\n  }\n  ngOnInit() {\n    this.loadingService.setLoading(true);\n    const status$ = this.statusService.getStatuses();\n    const priorities$ = this.priorityService.getPriorities();\n    const categories$ = this.categoryService.getCategories();\n    const flujos$ = this.flujoService.getFlujos();\n    this.destroy$.push(forkJoin([status$, priorities$, categories$, flujos$]).subscribe({\n      next: ([statusResponse, prioritiesResponse, categoriesResponse, flujosResponse]) => {\n        this.status = this.statusService.materializeStatus(statusResponse);\n        this.priorityKeys = this.priorityService.materializePriorities(prioritiesResponse);\n        this.categoryKeys = this.categoryService.materializeCategories(categoriesResponse);\n        this.flujoKeys = this.flujoService.materializeFlujos(flujosResponse);\n        this.priorities = this.priorityKeys.map(p => p.nombre);\n        this.categories = this.categoryKeys.map(c => c.nombre);\n        this.flujos = this.flujoKeys.map(f => f.nombre);\n        this.loadingService.setLoading(false);\n      },\n      error: err => {\n        this.toastr.error('Error al cargar datos', 'Error');\n        this.loadingService.setLoading(false);\n      }\n    }));\n  }\n  ngOnDestroy() {\n    this.destroy$.forEach(d => d.unsubscribe());\n  }\n  onSubmitTicket() {\n    debugger;\n    this.loadingService.setLoading(true);\n    const ticketRequest = this.ticketForm.value;\n    const request = this.materializeTicketRequest(ticketRequest);\n    this.destroy$.push(this.ticketService.createTicket(request).subscribe({\n      next: response => {\n        this.ticketResponse = response;\n        this.toastr.success(this.ticketResponse?.message, 'Ticket creado');\n        this.ticketForm.reset();\n        this.router.navigateByUrl('/my-tickets');\n        this.loadingService.setLoading(false);\n      },\n      error: err => {\n        this.toastr.error(err?.message, 'Error al crear ticket');\n        this.ticketForm.reset();\n        this.loadingService.setLoading(false);\n      }\n    }));\n  }\n  materializeTicketRequest(ticket) {\n    const createTicketRequest = {\n      asunto: ticket.asunto,\n      contenido: ticket.contenido,\n      prioridad_id: this.priorityKeys.find(p => p.nombre == ticket.prioritiesSelect)?._id,\n      categoria_id: this.categoryKeys.find(c => c.nombre == ticket.categoriesSelect)?._id,\n      estado_id: this.status.find(s => s.nombre == status.pending)?._id,\n      trabajo_flujo_id: this.flujoKeys.find(f => f.nombre == ticket.flujosSelect)?._id\n    };\n    return createTicketRequest;\n  }\n}\nCreateTicketsComponent.ɵfac = function CreateTicketsComponent_Factory(t) {\n  return new (t || CreateTicketsComponent)(i0.ɵɵdirectiveInject(i1.TicketService), i0.ɵɵdirectiveInject(i2.ToastrService), i0.ɵɵdirectiveInject(i3.StatusService), i0.ɵɵdirectiveInject(i4.PriorityService), i0.ɵɵdirectiveInject(i5.CategoriesService), i0.ɵɵdirectiveInject(i6.FlujoService), i0.ɵɵdirectiveInject(i7.Router), i0.ɵɵdirectiveInject(i8.LoadingService));\n};\nCreateTicketsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CreateTicketsComponent,\n  selectors: [[\"app-create-tickets\"]],\n  decls: 37,\n  vars: 4,\n  consts: [[1, \"main-content\", \"mt-4\"], [1, \"form-group\", \"bg-light\", \"rounded\", \"form-style\", 3, \"formGroup\", \"submit\"], [1, \"text-light\", \"bg-primary\", \"header-form\"], [1, \"text-center\"], [1, \"p-4\"], [1, \"grid-container\"], [\"for\", \"prioritiesList\", 1, \"form-label\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-list-ol\", 2, \"font-size\", \".9rem\", \"margin-right\", \".5rem\"], [\"formControlName\", \"prioritiesSelect\", \"id\", \"prioritiesList\", 1, \"form-select\", \"select-style\"], [\"class\", \"option-style\", 3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"categoriesList\", 1, \"form-label\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-cogs\", 2, \"font-size\", \".9rem\", \"margin-right\", \".5rem\"], [\"formControlName\", \"categoriesSelect\", \"id\", \"categoriesList\", 1, \"form-select\", \"select-style\"], [\"for\", \"flujosList\", 1, \"form-label\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-sort-amount-asc\", 2, \"font-size\", \".9rem\", \"margin-right\", \".5rem\"], [\"formControlName\", \"flujosSelect\", \"id\", \"flujosList\", 1, \"form-select\", \"select-style\"], [\"for\", \"asunto\", 1, \"form-label\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-envelope-open\", 2, \"font-size\", \".9rem\", \"margin-right\", \".5rem\"], [\"formControlName\", \"asunto\", \"type\", \"text\", \"id\", \"asunto\", 1, \"form-control\", \"mb-3\", \"mt-2\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-pencil\", 2, \"font-size\", \".9rem\", \"margin-right\", \".5rem\"], [\"formControlName\", \"contenido\", 1, \"form-control\", \"mb-3\", \"mt-2\", 2, \"height\", \"200px\"], [1, \"d-flex\", \"justify-content-center\", \"w-100\"], [\"type\", \"submit\", 1, \"btn\", \"btn-lg\", \"btn-primary\", \"mb-2\"], [1, \"option-style\", 3, \"value\"], [1, \"option-text\"]],\n  template: function CreateTicketsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"main\", 0)(1, \"section\")(2, \"form\", 1);\n      i0.ɵɵlistener(\"submit\", function CreateTicketsComponent_Template_form_submit_2_listener() {\n        return ctx.onSubmitTicket();\n      });\n      i0.ɵɵelementStart(3, \"header\", 2)(4, \"h3\", 3);\n      i0.ɵɵtext(5, \"Crear Ticket\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(6, \"section\", 4)(7, \"div\", 5)(8, \"div\")(9, \"label\", 6);\n      i0.ɵɵelement(10, \"i\", 7);\n      i0.ɵɵtext(11, \"Prioridad: \");\n      i0.ɵɵelementStart(12, \"select\", 8);\n      i0.ɵɵtemplate(13, CreateTicketsComponent_option_13_Template, 3, 2, \"option\", 9);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(14, \"div\")(15, \"label\", 10);\n      i0.ɵɵelement(16, \"i\", 11);\n      i0.ɵɵtext(17, \"Categorias: \");\n      i0.ɵɵelementStart(18, \"select\", 12);\n      i0.ɵɵtemplate(19, CreateTicketsComponent_option_19_Template, 3, 2, \"option\", 9);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(20, \"div\")(21, \"label\", 13);\n      i0.ɵɵelement(22, \"i\", 14);\n      i0.ɵɵtext(23, \"Flujo: \");\n      i0.ɵɵelementStart(24, \"select\", 15);\n      i0.ɵɵtemplate(25, CreateTicketsComponent_option_25_Template, 3, 2, \"option\", 9);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(26, \"label\", 16);\n      i0.ɵɵelement(27, \"i\", 17);\n      i0.ɵɵtext(28, \"Asunto: \");\n      i0.ɵɵelement(29, \"input\", 18);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(30, \"label\");\n      i0.ɵɵelement(31, \"i\", 19);\n      i0.ɵɵtext(32, \"Contenido: \");\n      i0.ɵɵelement(33, \"textarea\", 20);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"section\", 21)(35, \"button\", 22);\n      i0.ɵɵtext(36, \"Crear Ticket\");\n      i0.ɵɵelementEnd()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"formGroup\", ctx.ticketForm);\n      i0.ɵɵadvance(11);\n      i0.ɵɵproperty(\"ngForOf\", ctx.priorities);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngForOf\", ctx.categories);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngForOf\", ctx.flujos);\n    }\n  },\n  dependencies: [i9.NgForOf, i10.ɵNgNoValidate, i10.NgSelectOption, i10.ɵNgSelectMultipleOption, i10.DefaultValueAccessor, i10.SelectControlValueAccessor, i10.NgControlStatus, i10.NgControlStatusGroup, i10.FormGroupDirective, i10.FormControlName],\n  styles: [\".grid-container[_ngcontent-%COMP%] {\\n        display: grid;\\n        grid-template-columns: repeat(3, 1fr);\\n        gap: 1.2rem;\\n      }\\n\\n      .select-style[_ngcontent-%COMP%] {\\n        width: 100%;\\n        margin-top: 0.5rem;\\n        border: 1px solid #ccc;\\n        border-radius: 4px;\\n        background-color: #fff;\\n        color: #000;\\n        font-size: 1rem;\\n        height: 1.8rem;\\n        cursor: pointer;\\n        box-shadow: -7px 4px 11px 2px rgb(0 0 0 / 5%);\\n      }\\n\\n      .select-style[_ngcontent-%COMP%]:focus {\\n        border: 1px solid #aaa;\\n        box-shadow: 0 0 1px 3px rgba(59, 153, 252, 0.7);\\n        box-shadow: 0 0 0 3px -moz-mac-focusring;\\n        color: #000;\\n        outline: none;\\n      }\\n      input[type='text'][_ngcontent-%COMP%] {\\n        \\n        box-shadow: -7px 4px 11px 2px rgb(0 0 0 / 5%);\\n      }\\n      textarea[_ngcontent-%COMP%] {\\n        box-shadow: -7px 4px 11px 2px rgb(0 0 0 / 5%);\\n      }\\n\\n      .form-style[_ngcontent-%COMP%] {\\n        display: flex;\\n        flex-direction: column;\\n        gap: 1rem;\\n        box-shadow: -6px 9px 18px 0px rgba(75,75,75,0.52);\\n        -webkit-box-shadow: -6px 9px 18px 0px rgba(75,75,75,0.52);\\n        -moz-box-shadow: -6px 9px 18px 0px rgba(75,75,75,0.52);\\n        border-radius: 4px;\\n\\n      }\\n\\n      label[_ngcontent-%COMP%] {\\n        width: 100%;\\n        font-size: 1.2rem;\\n        font-weight: 600;\\n      }\\n\\n      .header-form[_ngcontent-%COMP%] {\\n        padding: .5rem 1rem;\\n        border-radius: 4px 4px 0 0;\\n      }\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcGFnZXMvY3JlYXRlLXRpY2tldHMvY3JlYXRlLXRpY2tldHMuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7TUFDTTtRQUNFLGFBQWE7UUFDYixxQ0FBcUM7UUFDckMsV0FBVztNQUNiOztNQUVBO1FBQ0UsV0FBVztRQUNYLGtCQUFrQjtRQUNsQixzQkFBc0I7UUFDdEIsa0JBQWtCO1FBQ2xCLHNCQUFzQjtRQUN0QixXQUFXO1FBQ1gsZUFBZTtRQUNmLGNBQWM7UUFDZCxlQUFlO1FBQ2YsNkNBQTZDO01BQy9DOztNQUVBO1FBQ0Usc0JBQXNCO1FBQ3RCLCtDQUErQztRQUMvQyx3Q0FBd0M7UUFDeEMsV0FBVztRQUNYLGFBQWE7TUFDZjtNQUNBOztRQUVFLDZDQUE2QztNQUMvQztNQUNBO1FBQ0UsNkNBQTZDO01BQy9DOztNQUVBO1FBQ0UsYUFBYTtRQUNiLHNCQUFzQjtRQUN0QixTQUFTO1FBQ1QsaURBQWlEO1FBQ2pELHlEQUF5RDtRQUN6RCxzREFBc0Q7UUFDdEQsa0JBQWtCOztNQUVwQjs7TUFFQTtRQUNFLFdBQVc7UUFDWCxpQkFBaUI7UUFDakIsZ0JBQWdCO01BQ2xCOztNQUVBO1FBQ0UsbUJBQW1CO1FBQ25CLDBCQUEwQjtNQUM1QiIsInNvdXJjZXNDb250ZW50IjpbIlxuICAgICAgLmdyaWQtY29udGFpbmVyIHtcbiAgICAgICAgZGlzcGxheTogZ3JpZDtcbiAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoMywgMWZyKTtcbiAgICAgICAgZ2FwOiAxLjJyZW07XG4gICAgICB9XG5cbiAgICAgIC5zZWxlY3Qtc3R5bGUge1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgbWFyZ2luLXRvcDogMC41cmVtO1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xuICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7XG4gICAgICAgIGNvbG9yOiAjMDAwO1xuICAgICAgICBmb250LXNpemU6IDFyZW07XG4gICAgICAgIGhlaWdodDogMS44cmVtO1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIGJveC1zaGFkb3c6IC03cHggNHB4IDExcHggMnB4IHJnYigwIDAgMCAvIDUlKTtcbiAgICAgIH1cblxuICAgICAgLnNlbGVjdC1zdHlsZTpmb2N1cyB7XG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNhYWE7XG4gICAgICAgIGJveC1zaGFkb3c6IDAgMCAxcHggM3B4IHJnYmEoNTksIDE1MywgMjUyLCAwLjcpO1xuICAgICAgICBib3gtc2hhZG93OiAwIDAgMCAzcHggLW1vei1tYWMtZm9jdXNyaW5nO1xuICAgICAgICBjb2xvcjogIzAwMDtcbiAgICAgICAgb3V0bGluZTogbm9uZTtcbiAgICAgIH1cbiAgICAgIGlucHV0W3R5cGU9J3RleHQnXSB7XG4gICAgICAgIFxuICAgICAgICBib3gtc2hhZG93OiAtN3B4IDRweCAxMXB4IDJweCByZ2IoMCAwIDAgLyA1JSk7XG4gICAgICB9XG4gICAgICB0ZXh0YXJlYSB7XG4gICAgICAgIGJveC1zaGFkb3c6IC03cHggNHB4IDExcHggMnB4IHJnYigwIDAgMCAvIDUlKTtcbiAgICAgIH1cblxuICAgICAgLmZvcm0tc3R5bGUge1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICBnYXA6IDFyZW07XG4gICAgICAgIGJveC1zaGFkb3c6IC02cHggOXB4IDE4cHggMHB4IHJnYmEoNzUsNzUsNzUsMC41Mik7XG4gICAgICAgIC13ZWJraXQtYm94LXNoYWRvdzogLTZweCA5cHggMThweCAwcHggcmdiYSg3NSw3NSw3NSwwLjUyKTtcbiAgICAgICAgLW1vei1ib3gtc2hhZG93OiAtNnB4IDlweCAxOHB4IDBweCByZ2JhKDc1LDc1LDc1LDAuNTIpO1xuICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG5cbiAgICAgIH1cblxuICAgICAgbGFiZWwge1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgZm9udC1zaXplOiAxLjJyZW07XG4gICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gICAgICB9XG5cbiAgICAgIC5oZWFkZXItZm9ybSB7XG4gICAgICAgIHBhZGRpbmc6IC41cmVtIDFyZW07XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDRweCA0cHggMCAwO1xuICAgICAgfVxuICAgICJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["FormControl","FormGroup","status","forkJoin","i0","CreateTicketsComponent","constructor","ticketService","toastr","statusService","priorityService","categoryService","flujoService","router","loadingService","ticketForm","prioritiesSelect","priorities","categoriesSelect","categories","flujosSelect","flujos","asunto","contenido","ngOnInit","setLoading","status$","getStatuses","priorities$","getPriorities","categories$","getCategories","flujos$","getFlujos","destroy$","push","subscribe","next","statusResponse","prioritiesResponse","categoriesResponse","flujosResponse","materializeStatus","priorityKeys","materializePriorities","categoryKeys","materializeCategories","flujoKeys","materializeFlujos","map","p","nombre","c","f","error","err","ngOnDestroy","forEach","d","unsubscribe","onSubmitTicket","ticketRequest","value","request","materializeTicketRequest","createTicket","response","ticketResponse","success","message","reset","navigateByUrl","ticket","createTicketRequest","prioridad_id","find","_id","categoria_id","estado_id","s","pending","trabajo_flujo_id","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\nayeli\\OneDrive\\Escritorio\\service-desk\\frontend\\src\\app\\pages\\create-tickets\\create-tickets.component.ts","C:\\Users\\nayeli\\OneDrive\\Escritorio\\service-desk\\frontend\\src\\app\\pages\\create-tickets\\create-tickets.component.html"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { FormControl, FormGroup } from '@angular/forms';\r\nimport { TicketService } from 'src/app/core';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport {\r\n  CreateTicket,\r\n  TicketPostResponse,\r\n  TicketSelect,\r\n} from 'src/app/core/interfaces/ticket.interface';\r\nimport { StatusService } from 'src/app/core/services/status.service';\r\nimport { CategoriesService } from 'src/app/core/services/categories.service';\r\nimport { Status } from 'src/app/core/interfaces/status.interface';\r\nimport { status } from '../estados/constant';\r\nimport { PriorityService } from 'src/app/core/services/priority.service';\r\nimport { Priority } from 'src/app/core/interfaces/priority.interface';\r\nimport { Category } from 'src/app/core/interfaces/categories.interface';\r\nimport { Flujo } from 'src/app/core/interfaces/flujo.interface';\r\nimport { FlujoService } from 'src/app/core/services/flujo.service';\r\nimport { Subscription, forkJoin } from 'rxjs';\r\nimport { LoadingService } from 'src/app/shared/loading';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-create-tickets',\r\n  templateUrl: './create-tickets.component.html',\r\n  styles: [\r\n    `\r\n      .grid-container {\r\n        display: grid;\r\n        grid-template-columns: repeat(3, 1fr);\r\n        gap: 1.2rem;\r\n      }\r\n\r\n      .select-style {\r\n        width: 100%;\r\n        margin-top: 0.5rem;\r\n        border: 1px solid #ccc;\r\n        border-radius: 4px;\r\n        background-color: #fff;\r\n        color: #000;\r\n        font-size: 1rem;\r\n        height: 1.8rem;\r\n        cursor: pointer;\r\n        box-shadow: -7px 4px 11px 2px rgb(0 0 0 / 5%);\r\n      }\r\n\r\n      .select-style:focus {\r\n        border: 1px solid #aaa;\r\n        box-shadow: 0 0 1px 3px rgba(59, 153, 252, 0.7);\r\n        box-shadow: 0 0 0 3px -moz-mac-focusring;\r\n        color: #000;\r\n        outline: none;\r\n      }\r\n      input[type='text'] {\r\n        \r\n        box-shadow: -7px 4px 11px 2px rgb(0 0 0 / 5%);\r\n      }\r\n      textarea {\r\n        box-shadow: -7px 4px 11px 2px rgb(0 0 0 / 5%);\r\n      }\r\n\r\n      .form-style {\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 1rem;\r\n        box-shadow: -6px 9px 18px 0px rgba(75,75,75,0.52);\r\n        -webkit-box-shadow: -6px 9px 18px 0px rgba(75,75,75,0.52);\r\n        -moz-box-shadow: -6px 9px 18px 0px rgba(75,75,75,0.52);\r\n        border-radius: 4px;\r\n\r\n      }\r\n\r\n      label {\r\n        width: 100%;\r\n        font-size: 1.2rem;\r\n        font-weight: 600;\r\n      }\r\n\r\n      .header-form {\r\n        padding: .5rem 1rem;\r\n        border-radius: 4px 4px 0 0;\r\n      }\r\n    `,\r\n  ],\r\n})\r\nexport class CreateTicketsComponent {\r\n  private destroy$: Subscription[] = [];\r\n  ticketForm: FormGroup;\r\n  \r\n\r\n  categories: string[] = [];\r\n  categoryKeys: Category[] = [];\r\n\r\n  ticketResponse: TicketPostResponse = {} as TicketPostResponse;\r\n  status: Status[] = [];\r\n\r\n  priorities: string[] = [];\r\n  priorityKeys: Priority[] = [];\r\n  \r\n  flujos: string[] = [];\r\n  flujoKeys: Flujo[] = [];\r\n\r\n  constructor(\r\n    private ticketService: TicketService,\r\n    private toastr: ToastrService,\r\n    private statusService: StatusService,\r\n    private priorityService: PriorityService,\r\n    private categoryService: CategoriesService,\r\n    private flujoService: FlujoService,\r\n    private router: Router,\r\n    private loadingService: LoadingService,\r\n  ) {\r\n    this.ticketForm = new FormGroup({\r\n      prioritiesSelect: new FormControl(this.priorities),\r\n      categoriesSelect: new FormControl(this.categories),\r\n      flujosSelect: new FormControl(this.flujos),\r\n      asunto: new FormControl(''),\r\n      contenido: new FormControl(''),\r\n    });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.loadingService.setLoading(true);\r\n    const status$ = this.statusService.getStatuses();\r\n    const priorities$ = this.priorityService.getPriorities();\r\n    const categories$ = this.categoryService.getCategories();\r\n    const flujos$ = this.flujoService.getFlujos();\r\n    \r\n    this.destroy$.push(\r\n      forkJoin([status$, priorities$, categories$, flujos$]).subscribe({\r\n        next: ([statusResponse, prioritiesResponse, categoriesResponse, flujosResponse ]) => {\r\n          this.status = this.statusService.materializeStatus(statusResponse);\r\n          this.priorityKeys = this.priorityService.materializePriorities(prioritiesResponse);\r\n          this.categoryKeys = this.categoryService.materializeCategories(categoriesResponse);\r\n          this.flujoKeys = this.flujoService.materializeFlujos(flujosResponse);\r\n          this.priorities = this.priorityKeys.map((p) => p.nombre);\r\n          this.categories = this.categoryKeys.map((c) => c.nombre);\r\n          this.flujos = this.flujoKeys.map((f) => f.nombre);\r\n          this.loadingService.setLoading(false);\r\n        },\r\n        error: (err) => {this.toastr.error('Error al cargar datos', 'Error'); this.loadingService.setLoading(false);},\r\n      })\r\n    )\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.destroy$.forEach((d) => d.unsubscribe());\r\n  }\r\n\r\n  onSubmitTicket() {\r\n    debugger\r\n    this.loadingService.setLoading(true);\r\n    const ticketRequest: TicketSelect = this.ticketForm.value;\r\n    const request: CreateTicket = this.materializeTicketRequest(ticketRequest);\r\n    this.destroy$.push(\r\n      this.ticketService.createTicket(request).subscribe({\r\n        next: (response) => {\r\n          this.ticketResponse = response;\r\n          this.toastr.success(this.ticketResponse?.message, 'Ticket creado');\r\n          this.ticketForm.reset();\r\n          this.router.navigateByUrl('/my-tickets');\r\n          this.loadingService.setLoading(false);\r\n        },\r\n        error: (err) => {\r\n          this.toastr.error(err?.message, 'Error al crear ticket');\r\n          this.ticketForm.reset();\r\n          this.loadingService.setLoading(false);\r\n        },\r\n      })\r\n    )\r\n  }\r\n\r\n  materializeTicketRequest(ticket: TicketSelect): CreateTicket {\r\n    const createTicketRequest: CreateTicket = {\r\n      asunto: ticket.asunto,\r\n      contenido: ticket.contenido,\r\n      prioridad_id: this.priorityKeys.find((p) => p.nombre == ticket.prioritiesSelect)?._id!,\r\n      categoria_id: this.categoryKeys.find((c) => c.nombre == ticket.categoriesSelect )?._id!,\r\n      estado_id: this.status.find((s) => s.nombre == status.pending)?._id!,\r\n      trabajo_flujo_id: this.flujoKeys.find((f) => f.nombre == ticket.flujosSelect)?._id!\r\n    };\r\n    return createTicketRequest;\r\n  }\r\n}\r\n","<main class=\"main-content mt-4\">\r\n  <section>\r\n    <form [formGroup]=\"ticketForm\" (submit)=\"onSubmitTicket()\" class=\"form-group bg-light rounded form-style \">  \r\n      <header class=\"text-light bg-primary header-form\">\r\n        <h3 class=\"text-center\">Crear Ticket</h3>\r\n      </header>\r\n      <section class=\"p-4\">\r\n        <div class=\"grid-container\">\r\n          <div>\r\n            <label class=\"form-label\" for=\"prioritiesList\">\r\n              <i class=\"fa fa-list-ol\" aria-hidden=\"true\" style=\"font-size: .9rem; margin-right: .5rem;\" ></i>Prioridad:\r\n              <select formControlName=\"prioritiesSelect\" class=\"form-select select-style\" id=\"prioritiesList\">\r\n                <option *ngFor=\"let priority of priorities\" [value]=\"priority\" class=\"option-style\">\r\n                  <p> {{ priority }} </p>\r\n                </option>\r\n              </select>\r\n            </label>\r\n          </div>\r\n  \r\n          <div>\r\n            <label class=\"form-label\" for=\"categoriesList\">\r\n              <i class=\"fa fa-cogs\" aria-hidden=\"true\" style=\"font-size: .9rem; margin-right: .5rem;\" ></i>Categorias:\r\n              <select formControlName=\"categoriesSelect\" class=\"form-select select-style\" id=\"categoriesList\">\r\n                <option class=\"option-style\" *ngFor=\"let category of categories\" [value]=\"category\">\r\n                  <p> {{ category }} </p>\r\n                </option>\r\n              </select>\r\n            </label>\r\n          </div>\r\n  \r\n  \r\n          <div>\r\n            <label class=\"form-label\" for=\"flujosList\">\r\n              <i class=\"fa fa-sort-amount-asc\" aria-hidden=\"true\" style=\"font-size: .9rem; margin-right: .5rem;\"></i>Flujo:\r\n              <select formControlName=\"flujosSelect\" class=\"form-select select-style\" id=\"flujosList\">\r\n                <option class=\"option-style\" *ngFor=\"let flujo of flujos\" [value]=\"flujo\">\r\n                  <p class=\"option-text\"> {{ flujo }} </p>\r\n                </option>\r\n              </select>\r\n            </label>\r\n          </div>\r\n  \r\n        </div>\r\n        <label class=\"form-label\" for=\"asunto\">\r\n          <i class=\"fa fa-envelope-open\" aria-hidden=\"true\" style=\"font-size: .9rem; margin-right: .5rem;\"></i>Asunto:\r\n          <input formControlName=\"asunto\" class=\"form-control mb-3 mt-2\" type=\"text\" id=\"asunto\" />\r\n        </label>\r\n        <label>\r\n          <i class=\"fa fa-pencil\" aria-hidden=\"true\" style=\"font-size: .9rem; margin-right: .5rem;\"></i>Contenido:\r\n          <textarea formControlName=\"contenido\" class=\"form-control mb-3 mt-2\" style=\"height: 200px\"></textarea>\r\n        </label>\r\n        <section class=\"d-flex justify-content-center w-100\">\r\n          <button class=\"btn btn-lg btn-primary mb-2\" type=\"submit\">Crear Ticket</button>\r\n        </section>\r\n      </section>\r\n    </form>\r\n  </section>\r\n</main>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}